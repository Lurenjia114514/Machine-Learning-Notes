# 特殊运算

## 张量积

设矩阵 $\boldsymbol{A}_{m\times n}$ 和 $\boldsymbol{B}$, 它们的张量积为
$$
\boldsymbol{A} \otimes \boldsymbol{B} =
\begin{bmatrix}
a_{11} \boldsymbol{B} & a_{12} \boldsymbol{B} & \cdots & a_{1n} \boldsymbol{B} \\
a_{21} \boldsymbol{B} & a_{22} \boldsymbol{B} & \cdots & a_{2n} \boldsymbol{B}\\
\vdots   & \vdots   & \ddots & \vdots   \\
a_{m1} \boldsymbol{B}& a_{m2} \boldsymbol{B} & \cdots & a_{mn} \boldsymbol{B}
\end{bmatrix}
$$

张量积具有如下性质:

1. 结合律
   $$
   (\boldsymbol{A} \otimes \boldsymbol{B} )\otimes \boldsymbol{C}=\boldsymbol{A} \otimes (\boldsymbol{B} \otimes \boldsymbol{C})
   $$
2. 分配律
   $$
   \begin{align}
   (\boldsymbol{A}_1 \otimes \boldsymbol{A}_2 )\otimes \boldsymbol{B}&=(\boldsymbol{A}_1\otimes \boldsymbol{B})+(\boldsymbol{A}_2\otimes \boldsymbol{B})\\
   \boldsymbol{A}\otimes (\boldsymbol{B}_1 \otimes \boldsymbol{B}_2 ) &=(\boldsymbol{A}\otimes \boldsymbol{B}_1)+(\boldsymbol{A}\otimes \boldsymbol{B}_2)
   \end{align}
   $$
3. 数乘
   $$
   (\alpha\boldsymbol{A})\otimes (\beta\boldsymbol{B})=\alpha\beta(\boldsymbol{A}\otimes\boldsymbol{B})
   $$
4. 矩阵乘法
   $$
   (\boldsymbol{A}_1 \otimes \boldsymbol{A}_2 )(\boldsymbol{B}_1 \otimes \boldsymbol{B}_2 )=(\boldsymbol{A}_1\boldsymbol{B}_1)\otimes(\boldsymbol{A}_2\boldsymbol{B}_2)
   $$
5. 矩阵转置
   $$
   (\boldsymbol{A}\otimes \boldsymbol{B})^{\mathrm{T}}=\boldsymbol{A}^{\mathrm{T}}\otimes \boldsymbol{B}^{\mathrm{T}}
   $$
6. 矩阵的逆
   $$
   (\boldsymbol{A}\otimes \boldsymbol{B})^{-1}=\boldsymbol{A}^{-1}\otimes \boldsymbol{B}^{-1}
   $$
7. 矩阵的迹
   $$
   \mathrm{tr}(\boldsymbol{A}\otimes \boldsymbol{B})=\mathrm{tr}(\boldsymbol{A})\otimes\mathrm{tr}(\boldsymbol{B})
   $$
8. 行列式
   $$
   |\boldsymbol{A}\otimes \boldsymbol{B}|=|\boldsymbol{A}|^n|\boldsymbol{B}|^m
   $$
   其中 $\boldsymbol{A}$ 和 $\boldsymbol{B}$ 分别为 $m$ 和 $n$ 阶方阵.

## 拉直运算

设矩阵 $\boldsymbol{A}$ 为一个 $m\times n$ 的矩阵, 它的列向量组为 $\boldsymbol{a}_1,\cdots,\boldsymbol{a}_n$, 则 $\boldsymbol{A}$ 的拉直运算为
$$
\mathrm{Vec}(\boldsymbol{A})=
\begin{bmatrix}
\boldsymbol{a}_1 \\ \cdots \\
\boldsymbol{a}_n
\end{bmatrix}
$$

拉直运算具有如下性质:

1. 线性性

   $$
   \begin{align}
   \mathrm{Vec}(\boldsymbol{A}+\boldsymbol{B})&=\mathrm{Vec}(\boldsymbol{A})+\mathrm{Vec}(\boldsymbol{B})\\
   \mathrm{Vec}(\alpha\boldsymbol{A})&=\alpha\mathrm{Vec}(\boldsymbol{A})
   \end{align}
   $$
2. 其他

$$
   \begin{align}
   \mathrm{tr}(\boldsymbol{A}\boldsymbol{B})&=(\mathrm{Vec}(\boldsymbol{A}^{\mathrm{T}}))^{\mathrm{T}}\mathrm{Vec}(\boldsymbol{B})\\
   \mathrm{Vec}(\boldsymbol{a}\boldsymbol{b}^{\mathrm{T}})&=\boldsymbol{b}\otimes\boldsymbol{a}\\
   \mathrm{Vec}(\boldsymbol{A}\boldsymbol{B}\boldsymbol{C})&=(\boldsymbol{C}^{\mathrm{T}}\otimes\boldsymbol{A})\mathrm{Vec}(\boldsymbol{B})
   \end{align}
$$

## 行列式和迹

### 行列式

对于可逆线性映射
$$
\Phi:\mathbb{R}^n\rightarrow\mathbb{R}^n,~x\rightarrow\Phi(\boldsymbol{x})=\boldsymbol{A}(\boldsymbol{x})
$$

其中矩阵 $\boldsymbol{A}$ 为 $n$ 阶可逆方阵, 则行列式 $\mathrm{det}(\boldsymbol{A})$ 的绝对值可视为可逆线性变换的单位面积的伸缩比例.

### 迹

矩阵 $\boldsymbol{A}_n$ 的迹为
$$
\mathrm{tr}(\boldsymbol{A})=\sum_{i=1}^na_{i,i}
$$

矩阵的迹满足线性性和轮换对称性:
$$
\begin{align}
\mathrm{tr}(\alpha\boldsymbol{A}+\beta\boldsymbol{B})&=\alpha\mathrm{tr}(\boldsymbol{A})+\beta\mathrm{tr}(\boldsymbol{B})\\
\mathrm{tr}(\boldsymbol{AB})&=\mathrm{tr}(\boldsymbol{BA})
\end{align}
$$

由轮换对称性我们有
$$
\begin{align}
\mathrm{tr}(\boldsymbol{ABC})&=\mathrm{tr}(\boldsymbol{BCA})=\mathrm{tr}(\boldsymbol{CAB})\\
\mathrm{tr}(\boldsymbol{x}\boldsymbol{y}^{\mathrm{T}})&=\mathrm{tr}(\boldsymbol{y}^{\mathrm{T}}\boldsymbol{x})=\boldsymbol{y}^{\mathrm{T}}\boldsymbol{x}
\end{align}
$$

相似的两矩阵 $\boldsymbol{A}$ 和 $\boldsymbol{B}$ 满足 $\boldsymbol{A}=\boldsymbol{P}^{-1}\boldsymbol{B}\boldsymbol{P}$, 具有相同的特征值, 于是具有相同的特征向量, 行列式和迹
$$
\begin{align}
\mathrm{det}(\boldsymbol{A})&=\prod_{i=1}^n\lambda_i\\
\mathrm{tr}(\boldsymbol{A})&=\sum_{i=1}^n\lambda_i\\
\end{align}
$$

若将特征值视为边长, 我们可将行列式理解为矩阵的面积, 迹理解为矩阵的半周长. 当我们将矩阵分解为矩阵乘积时, 分解与行列式有关; 当我们将矩阵分解为矩阵之和时, 分解与迹有关.

## 范数

### 向量范数

常见的向量范数有

1. $l_1$ 范数
   $$
   ||\boldsymbol{x}||_1=\sum_{i=1}^n|x_i|
   $$
   $l_1$ 范数又称为稀疏规则算子, 我们可以通过 $l_1$ 范数过滤稀疏数据中的无用特征, 例如 $Lasso$ 回归.

2. $l_2$ 范数
   $$
   ||\boldsymbol{x}||_2=(\sum_{i=1}^nx_i^2)^{\frac{1}{2}}
   $$
   我们常用 $l_2$ 范数作为损失函数的正则项, 防止模型过拟合, 提升模型的泛化能力.

3. $l_{\infty}$ 范数
   $$
   ||\boldsymbol{x}||_{\infty}=\max_{1\le i\le n}|x_i|
   $$

4. $l_p$ 范数
   $$
   ||\boldsymbol{x}||_p=(\sum_{i=1}^n|x_i|^p)^{\frac{1}{p}}
   $$

   ![1](Image\f140a435e2a8911d010e089df87b8add.png)

5. 椭圆范数
   向量关于正定矩阵 $\boldsymbol{A}$ 的椭圆范数为
   $$
   ||\boldsymbol{x}||_{\boldsymbol{A}}=\sqrt{\boldsymbol{x}\boldsymbol{A}^{\mathrm{T}}\boldsymbol{x}}
   $$

### 矩阵范数

常见的矩阵范数有

1. $l_1$ 范数
   $$
   ||\boldsymbol{A}||_{m_1}=\sum_{i=1}^m\sum_{j=1}^n|a_{i,j}|
   $$

2. $l_1$ 范数或称 $F$ 范数
   $$
   ||\boldsymbol{A}||_{F}=(\sum_{i=1}^m\sum_{j=1}^n|a_{i,j}|^2)^{\frac{1}{2}}
   $$

3. $l_{\infty}$
   $$
   ||\boldsymbol{A}||_{m_{\infty}}=\max_{i\le i\le m,1\le j\le n}|a_{i,j}|
   $$

4. 由向量 $l_2$ 范数诱导的矩阵范数
   $$
   ||\boldsymbol{A}||_2=\max_{||\boldsymbol{x}||=1}||\boldsymbol{A}\boldsymbol{x}||=\max_{||\boldsymbol{x}||\ne 0}\frac{||\boldsymbol{A}\boldsymbol{x}||}{||\boldsymbol{x}||}=\sqrt{\lambda_1}
   $$
   其中 $\lambda_1$ 为 $\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}$ 的最大特征值.