# 特殊运算

## 张量积

设矩阵 $\boldsymbol{A}_{m\times n}$ 和 $\boldsymbol{B}$, 它们的张量积为
$$
\boldsymbol{A} \otimes \boldsymbol{B} =
\begin{bmatrix}
a_{11} \boldsymbol{B} & a_{12} \boldsymbol{B} & \cdots & a_{1n} \boldsymbol{B} \\
a_{21} \boldsymbol{B} & a_{22} \boldsymbol{B} & \cdots & a_{2n} \boldsymbol{B}\\
\vdots   & \vdots   & \ddots & \vdots   \\
a_{m1} \boldsymbol{B}& a_{m2} \boldsymbol{B} & \cdots & a_{mn} \boldsymbol{B}
\end{bmatrix}
$$

张量积具有如下性质:

1. 结合律
   $$
   (\boldsymbol{A} \otimes \boldsymbol{B} )\otimes \boldsymbol{C}=\boldsymbol{A} \otimes (\boldsymbol{B} \otimes \boldsymbol{C})
   $$
2. 分配律
   $$
   \begin{align}
   (\boldsymbol{A}_1 \otimes \boldsymbol{A}_2 )\otimes \boldsymbol{B}&=(\boldsymbol{A}_1\otimes \boldsymbol{B})+(\boldsymbol{A}_2\otimes \boldsymbol{B})\\
   \boldsymbol{A}\otimes (\boldsymbol{B}_1 \otimes \boldsymbol{B}_2 ) &=(\boldsymbol{A}\otimes \boldsymbol{B}_1)+(\boldsymbol{A}\otimes \boldsymbol{B}_2)
   \end{align}
   $$
3. 数乘
   $$
   (\alpha\boldsymbol{A})\otimes (\beta\boldsymbol{B})=\alpha\beta(\boldsymbol{A}\otimes\boldsymbol{B})
   $$
4. 矩阵乘法
   $$
   (\boldsymbol{A}_1 \otimes \boldsymbol{A}_2 )(\boldsymbol{B}_1 \otimes \boldsymbol{B}_2 )=(\boldsymbol{A}_1\boldsymbol{B}_1)\otimes(\boldsymbol{A}_2\boldsymbol{B}_2)
   $$
5. 矩阵转置
   $$
   (\boldsymbol{A}\otimes \boldsymbol{B})^{\mathrm{T}}=\boldsymbol{A}^{\mathrm{T}}\otimes \boldsymbol{B}^{\mathrm{T}}
   $$
6. 矩阵的逆
   $$
   (\boldsymbol{A}\otimes \boldsymbol{B})^{-1}=\boldsymbol{A}^{-1}\otimes \boldsymbol{B}^{-1}
   $$
7. 矩阵的迹
   $$
   \mathrm{tr}(\boldsymbol{A}\otimes \boldsymbol{B})=\mathrm{tr}(\boldsymbol{A})\otimes\mathrm{tr}(\boldsymbol{B})
   $$
8. 行列式
   $$
   |\boldsymbol{A}\otimes \boldsymbol{B}|=|\boldsymbol{A}|^n|\boldsymbol{B}|^m
   $$
   其中 $\boldsymbol{A}$ 和 $\boldsymbol{B}$ 分别为 $m$ 和 $n$ 阶方阵.

## 拉直运算

设矩阵 $\boldsymbol{A}$ 为一个 $m\times n$ 的矩阵, 它的列向量组为 $\boldsymbol{a}_1,\cdots,\boldsymbol{a}_n$, 则 $\boldsymbol{A}$ 的拉直运算为
$$
\mathrm{Vec}(\boldsymbol{A})=
\begin{bmatrix}
\boldsymbol{a}_1 \\ \cdots \\
\boldsymbol{a}_n
\end{bmatrix}
$$

拉直运算具有如下性质:

1. 线性性
   $$
   \begin{align}
   \mathrm{Vec}(\boldsymbol{A}+\boldsymbol{B})&=\mathrm{Vec}(\boldsymbol{A})+\mathrm{Vec}(\boldsymbol{B})\\
   \mathrm{Vec}(\alpha\boldsymbol{A})&=\alpha\mathrm{Vec}(\boldsymbol{A})
   \end{align}
   $$
2. 其他
   $$
   \begin{align}
   \mathrm{tr}(\boldsymbol{A}\boldsymbol{B})&=(\mathrm{Vec}(\boldsymbol{A}^{\mathrm{T}}))^{\mathrm{T}}\mathrm{Vec}(\boldsymbol{B})\\
   \mathrm{Vec}(\boldsymbol{a}\boldsymbol{b}^{\mathrm{T}})&=\boldsymbol{b}\otimes\boldsymbol{a}\\
   \mathrm{Vec}(\boldsymbol{A}\boldsymbol{B}\boldsymbol{C})&=(\boldsymbol{C}^{\mathrm{T}}\otimes\boldsymbol{A})\mathrm{Vec}(\boldsymbol{B})
   \end{align}
   $$