# 矩阵分解

## 重要矩阵

### 对称矩阵

对于 $n$ 阶方阵 $\boldsymbol{A}$, 若满足 $\boldsymbol{A}^{\mathrm{T}}=\boldsymbol{A}$, 则称 $\boldsymbol{A}$ 为对称矩阵.

实对称矩阵具有如下性质:

1. 实对称矩阵的特征值均为实数, 其特征向量均为实向量;
2. 实对称矩阵的不同特征对应特征向量是正交的.

### 正定矩阵

设 $\boldsymbol{A}$ 为 $n$ 阶对称矩阵, 若对于任意非零向量 $\boldsymbol{x}\in\mathbb{R}^n$, 均有 $\boldsymbol{x}^{\mathrm{T}}\boldsymbol{A}\boldsymbol{x}>0$, 则称 $\boldsymbol{A}$ 为正定矩阵, 记为 $\boldsymbol{A}>0$.

对称矩阵 $\boldsymbol{A}$ 为正定矩阵当且仅当 $\boldsymbol{A}$ 的所有特征值均大于 $0$, 或者 $\boldsymbol{A}$ 可分解为 $\boldsymbol{A}=\boldsymbol{B}\boldsymbol{B}^{\mathrm{T}}$, 其中 $\boldsymbol{B}$ 为 $n$ 阶可逆矩阵.

### 半正定矩阵

设 $\boldsymbol{A}$ 为 $n$ 阶对称矩阵, 若对于任意非零向量 $\boldsymbol{x}\in\mathbb{R}^n$, 均有 $\boldsymbol{x}^{\mathrm{T}}\boldsymbol{A}\boldsymbol{x}\ge0$, 则称 $\boldsymbol{A}$ 为半正定矩阵, 记为 $\boldsymbol{A}\ge0$.

对称矩阵 $\boldsymbol{A}$ 为半正定矩阵当且仅当 $\boldsymbol{A}$ 的所有特征值均大于等于 $0$, 或者 $\boldsymbol{A}$ 可分解为 $\boldsymbol{A}=\boldsymbol{B}\boldsymbol{B}^{\mathrm{T}}$, 其中 $\boldsymbol{B}$ 为 $n\times r$ 的列满秩矩阵, $r=\mathrm{rank}(\boldsymbol{A})$

## 常见的矩阵分解

### $QR$ 分解

设 $\boldsymbol{A}$ 为 $n\times m$ 矩阵, 其中 $n\ge m$, 则矩阵 $\boldsymbol{A}$ 可分解为
$$
\boldsymbol{A}=\boldsymbol{Q}\boldsymbol{R}
$$
其中 $\boldsymbol{Q}$ 为 $n\times m$ 的列正交矩阵, $\boldsymbol{R}$ 为上三角矩阵, 主对角线元素非负. 当矩阵 $\boldsymbol{A}$ 列满秩, 即 $\mathrm{rank}(\boldsymbol{A})=m$ 时, 矩阵 $\boldsymbol{R}$ 的主对角线元素全正.

### $Cholesky$ 分解

设 $\boldsymbol{C}$ 为 $n$ 阶正定矩阵, 则矩阵 $\boldsymbol{C}$ 可分解为
$$
\boldsymbol{C}=\boldsymbol{T}\boldsymbol{T}^{\mathrm{T}}
$$
其中 $\boldsymbol{T}$ 为下三角矩阵.

### 谱分解

矩阵 $\boldsymbol{A}$ 的特征值分解为 $\boldsymbol{A}=\boldsymbol{P}\boldsymbol{\Lambda}\boldsymbol{P}^{-1}$, 其中 $\boldsymbol{P}$ 可逆.

设 $\boldsymbol{A}$ 为 $n$ 阶对称方阵, 其特征值为 $\lambda_1,\cdots,\lambda_n$, 其正交标准化特征向量为 $\boldsymbol{\varphi}_1,\cdots,\boldsymbol{\varphi}_n$, 则矩阵 $\boldsymbol{A}$ 可分解为
$$
\boldsymbol{A}=\boldsymbol{P}\boldsymbol{\Lambda}_n\boldsymbol{P}^{\mathrm{T}}=\sum_{i=1}^n\lambda_i\boldsymbol{\varphi}_i\boldsymbol{\varphi}_i^{\mathrm{T}}
$$
其中 $\boldsymbol{P}=(\boldsymbol{\varphi}_1,\cdots,\boldsymbol{\varphi}_n)$ 为 $n$ 阶正交方阵, $\boldsymbol{\Lambda}_n=\mathrm{diag}(\lambda_1,\cdots,\lambda_n)$ 为 $n$ 阶对角方阵.

设 $\boldsymbol{A}$ 为 $n$ 阶对称方阵, 则有
$$
\begin{align}
\mathrm{tr}(\boldsymbol{A})&=\sum_{i=1}^n\lambda_i\\
|\boldsymbol{A}|&=\prod_{i=1}^n\lambda_i
\end{align}
$$

当矩阵 $\boldsymbol{A}$ 不满秩时, 即 $\mathrm{rank}(A)=r<n$ 时, 则 $\boldsymbol{A}$ 仅有 $r$ 个非零特征值 $\lambda_1,\cdots,\lambda_r$, 则
$$
\boldsymbol{\Lambda}_n=
\begin{bmatrix}
\boldsymbol{\Lambda}_r & \boldsymbol{0}\\
\boldsymbol{0}& \boldsymbol{0}\\
\end{bmatrix}
$$
其中 $\boldsymbol{\Lambda}_r=\mathrm{diag}(\lambda_1,\cdots,\lambda_r)$. 若相应地对 $\boldsymbol{P}$ 进行分块, 使得 $\boldsymbol{P}_1$ 为 $n\times r$ 的矩阵
$$
\boldsymbol{P}=(\boldsymbol{P}_1,\boldsymbol{P}_2)
$$
则 $\boldsymbol{A}$ 的满秩谱分解为
$$
\boldsymbol{A}=\boldsymbol{P}_1\begin{bmatrix}
\boldsymbol{\Lambda}_r & \boldsymbol{0}\\
\boldsymbol{0}& \boldsymbol{0}\\
\end{bmatrix}\boldsymbol{P}_1^{\mathrm{T}}=\boldsymbol{P}_1\boldsymbol{\Lambda}_r\boldsymbol{P}_1^{\mathrm{T}}
$$

### 奇异值分解

#### 定义

设 $\boldsymbol{A}$ 为 $m\times n$ 的实矩阵, 且 $\mathrm{rank}(A)=r$, 则存在不唯一的两正交方阵 $\boldsymbol{U}$ 和 $\boldsymbol{V}$, 以及唯一的对角线元素降序非负的对角矩阵 $\boldsymbol{\Sigma}$, 使得 $\boldsymbol{A}$ 可分解为
$$
\begin{align}
\boldsymbol{A}&=\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\mathrm{T}}\\&=\boldsymbol{U}\begin{bmatrix}
\boldsymbol{\Sigma}_r & \boldsymbol{0}\\
\boldsymbol{0}& \boldsymbol{0}\\
\end{bmatrix}\boldsymbol{V}^{\mathrm{T}}=\boldsymbol{U}_r\boldsymbol{\Sigma}_r\boldsymbol{V}_r^{\mathrm{T}}\\&=\sigma\boldsymbol{u}_1\boldsymbol{v}_1^{\mathrm{T}}+\cdots+\sigma\boldsymbol{u}_r\boldsymbol{v}_r^{\mathrm{T}}
\end{align}
$$

称 $\sigma_i$ 为 $\boldsymbol{A}$ 的奇异值, 称 $\boldsymbol{U}_r$ 和 $\boldsymbol{V}_r$ 的列向量称为左奇异向量和右奇异向量, 称 $(3)$ 式为 $\boldsymbol{A}$ 的完全奇异值分解, 称 $(4)$ 式为 $\boldsymbol{A}$ 的紧奇异值分解, 称 $(5)$ 式为 $\boldsymbol{A}$ 的张量积展开.

若取矩阵 $\boldsymbol{A}$ 的最大的 $k$ 个奇异值, 且 $0<k<r=\mathrm{range}(\boldsymbol{A})$, 则 $\boldsymbol{A}$ 的截断奇异值分解为
$$
\boldsymbol{A}\approx\boldsymbol{U}_k\boldsymbol{\Sigma}_k\boldsymbol{V}_k^{\mathrm{T}}
$$

#### 几何解释

奇异值分解的几何解释为 $\boldsymbol{A}$ 作为一个线性映射, 可视为几何变换, 可视为旋转或反射变换 $\boldsymbol{U}$ 和 $\boldsymbol{V}$ 以及缩放变换 $\boldsymbol{\Sigma}$ 的复合变换.

#### 奇异值分解和特征值分解的关系

若对 $\boldsymbol{A}$ 奇异值分解 $\boldsymbol{A}=\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\mathrm{T}}$, 则有
$$
\begin{align}
\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}&=\boldsymbol{V}(\boldsymbol{\Sigma}^{\mathrm{T}}\boldsymbol{\Sigma})\boldsymbol{V}^{\mathrm{T}}\\
\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}}&=\boldsymbol{U}(\boldsymbol{\Sigma}^{\mathrm{T}}\boldsymbol{\Sigma})\boldsymbol{U}^{\mathrm{T}}
\end{align}
$$
则 $\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}$ 和 $\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}}$ 可特征值分解, 其特征值 $\sigma_i^2$ 由 $\boldsymbol{A}$ 的奇异值表示, 其特征向量分别由右奇异向量和左奇异向量表示.

从数据矩阵的角度来说, 对中心化数据矩阵进行奇异值分解, 即原数据矩阵的协方差矩阵进行特征值分解; 对标准化数据矩阵进行奇异值分解, 即对原数据矩阵的相关系数矩阵进行特征值分解.

#### 奇异值分解和四个子空间

若对 $\boldsymbol{A}$ 奇异值分解 $\boldsymbol{A}=\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\mathrm{T}}$, 则有
$$
\begin{align}
\boldsymbol{A}\boldsymbol{V}&=\boldsymbol{U}\boldsymbol{\Sigma}, ~~~\boldsymbol{A}\boldsymbol{v}_j=
\begin{cases}
\sigma_j\boldsymbol{u}_j,~~~j=1,\cdots,r\\
0,~~~~~~~j=r+1,\cdots,n
\end{cases}\\
\boldsymbol{A}^{\mathrm{T}}\boldsymbol{U}&=\boldsymbol{V}\boldsymbol{\Sigma}^{\mathrm{T}}, ~~~\boldsymbol{A}^{\mathrm{T}}\boldsymbol{u}_j=
\begin{cases}
\sigma_j\boldsymbol{u}_j,~~j=1,\cdots,r\\
0,~~~~~~~j=r+1,\cdots,m
\end{cases}
\end{align}
$$

$\boldsymbol{A}$ 的 $r$ 个右奇异向量 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_r$ 为行空间 $\mathrm{range}(\boldsymbol{A}^{\mathrm{T}})$ 的标准正交基;
$\boldsymbol{A}$ 的 $n-r$ 个右奇异向量 $\boldsymbol{v}_{r+1},\cdots,\boldsymbol{v}_n$ 为零空间 $\mathrm{null}(\boldsymbol{A})$ 的标准正交基;
$\boldsymbol{A}$ 的 $r$ 个左奇异向量 $\boldsymbol{u}_1,\cdots,\boldsymbol{u}_r$ 为列空间 $\mathrm{range}(\boldsymbol{A})$ 的标准正交基;
$\boldsymbol{A}$ 的 $m-r$ 个左奇异向量 $\boldsymbol{u}_{r+1},\cdots,\boldsymbol{u}_{m}$ 为左零空间 $\mathrm{null}(\boldsymbol{A}^{\mathrm{T}})$ 的标准正交基.

#### 手动奇异值分解

奇异值分解的步骤:

1. 求 $\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}$ 的特征值和特征向量;
2. 求由 $\boldsymbol{A}$ 的特征值组成的对角矩阵 $\boldsymbol{\Lambda}$ 和由 $\boldsymbol{A}$ 的特征向量组成的正交矩阵 $\boldsymbol{V}$.
3. 对于前 $r$ 个左奇异向量, 有 $\boldsymbol{u}_j=\frac{1}{\sigma _j}\boldsymbol{v}_j, ~~~j=1,\cdots,r$
4. 对于后 $m-r$ 个奇异向量, 求 $\boldsymbol{A}$ 的左零空间的一组正交标准基.
5. 求正交矩阵 $\boldsymbol{U}$.

#### 优化视角

我们的目标为在 $\mathbb{R}_n$ 中找到单位向量 $\boldsymbol{v}$, 使得投影 $\boldsymbol{A'}\boldsymbol{v}$ 的 $L_2$ 范数最大

$$
\arg\max_{\boldsymbol{v}}||\boldsymbol{A}\boldsymbol{v}||\\
\mathrm{subject ~to:}~||{\boldsymbol{v}}||=1
$$

该问题可转化为瑞利商问题
$$
\max_{\boldsymbol{v}\ne\boldsymbol{0}}\frac{{\boldsymbol{v}}^{\mathrm{T}}\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}{\boldsymbol{v}}}{{\boldsymbol{v}}^{\mathrm{T}}{\boldsymbol{v}}}=\sigma_1^2
$$

同理对于投影范数最小问题可转化为
$$
\min_{\boldsymbol{v}\ne\boldsymbol{0}}\frac{{\boldsymbol{v}}^{\mathrm{T}}\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}{\boldsymbol{v}}}{{\boldsymbol{v}}^{\mathrm{T}}{\boldsymbol{v}}}=\sigma_n^2
$$

此时 $\boldsymbol{v}$ 为矩阵 $\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}$ 的特征值对应的特征向量.

#### 矩阵的近似

矩阵 $\boldsymbol{A}$ 的 $Frobenius$ 范数(简称 $F$ 范数)为向量的 $L_2$ 范数在矩阵上的推广.
$$
||\boldsymbol{A}||_F=(\sum_{i=1}^m\sum_{j=1}^na_{i,j}^2)^{\frac{1}{2}}
$$

若对 $\boldsymbol{A}$ 进行奇异值分解 $\boldsymbol{A}=\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\mathrm{T}}$, 则有
$$
\begin{align}
||\boldsymbol{A}||_F&=\mathrm{tr}(\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A})=\mathrm{tr}(\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}})\\
&=(\sigma_1^2+\cdots+\sigma_r^2)^{\frac{1}{2}}
\end{align}
$$

矩阵 $\boldsymbol{A}$ 在 $F$ 范数下的秩 $k$ 最优近似 $\hat{\boldsymbol{A}}$ 为
$$
||\boldsymbol{A}-\hat{\boldsymbol{A}}||_F=\min_{\boldsymbol{S}\in\mathcal{M}}||\boldsymbol{A}-\boldsymbol{S}||_F
$$

其中 $\mathcal{M}$ 为 $\mathbb{R}_{m\times n}$ 中所有秩不大于 $k$ 的矩阵的集合.

若最优近似矩阵 $\hat{\boldsymbol{A}}$ 的奇异值为 $\sigma_1,\cdots, \sigma_r$, 则近似中的信息损失为
$$
||\boldsymbol{A}-\hat{\boldsymbol{A}}||_F=(\sigma_{k+1}^2+\cdots+\sigma_r^2)^{\frac{1}{2}}
$$

紧奇异值分解为 $F$ 范数下的无损最优近似, 而截断奇异值分解为在 $F$ 范数下的有损的秩 $k$ 最优近似.
