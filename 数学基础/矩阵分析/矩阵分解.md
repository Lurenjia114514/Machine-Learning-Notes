# 矩阵分解

## 重要矩阵

### 对称矩阵

对于 $n$ 阶方阵 $\boldsymbol{A}$, 若满足 $\boldsymbol{A}^{\mathrm{T}}=\boldsymbol{A}$, 则称 $\boldsymbol{A}$ 为对称矩阵.

实对称矩阵具有如下性质:

1. 实对称矩阵的特征值均为实数, 其特征向量均为实向量;
2. 实对称矩阵的不同特征对应特征向量是正交的.

### 正定矩阵

设 $\boldsymbol{A}$ 为 $n$ 阶对称矩阵, 若对于任意非零向量 $\boldsymbol{x}\in\mathbb{R}^n$, 均有 $\boldsymbol{x}^{\mathrm{T}}\boldsymbol{A}\boldsymbol{x}>0$, 则称 $\boldsymbol{A}$ 为正定矩阵, 记为 $\boldsymbol{A}>0$.

对称矩阵 $\boldsymbol{A}$ 为正定矩阵当且仅当 $\boldsymbol{A}$ 的所有特征值均大于 $0$, 或者 $\boldsymbol{A}$ 可分解为 $\boldsymbol{A}=\boldsymbol{B}\boldsymbol{B}^{\mathrm{T}}$, 其中 $\boldsymbol{B}$ 为 $n$ 阶可逆矩阵.

### 半正定矩阵

设 $\boldsymbol{A}$ 为 $n$ 阶对称矩阵, 若对于任意非零向量 $\boldsymbol{x}\in\mathbb{R}^n$, 均有 $\boldsymbol{x}^{\mathrm{T}}\boldsymbol{A}\boldsymbol{x}\ge0$, 则称 $\boldsymbol{A}$ 为半正定矩阵, 记为 $\boldsymbol{A}\ge0$.

对称矩阵 $\boldsymbol{A}$ 为半正定矩阵当且仅当 $\boldsymbol{A}$ 的所有特征值均大于等于 $0$, 或者 $\boldsymbol{A}$ 可分解为 $\boldsymbol{A}=\boldsymbol{B}\boldsymbol{B}^{\mathrm{T}}$, 其中 $\boldsymbol{B}$ 为 $n\times r$ 的列满秩矩阵, $r=\mathrm{rank}(\boldsymbol{A})$

## 常见的矩阵分解

### $QR$ 分解

设 $\boldsymbol{A}$ 为 $n\times m$ 矩阵, 其中 $n\ge m$, 则矩阵 $\boldsymbol{A}$ 可分解为
$$
\boldsymbol{A}=\boldsymbol{Q}\boldsymbol{R}
$$
其中 $\boldsymbol{Q}$ 为 $n\times m$ 的列正交矩阵, $\boldsymbol{R}$ 为上三角矩阵, 主对角线元素非负. 当矩阵 $\boldsymbol{A}$ 列满秩, 即 $\mathrm{rank}(\boldsymbol{A})=m$ 时, 矩阵 $\boldsymbol{R}$ 的主对角线元素全正.

### $Cholesky$ 分解

设 $\boldsymbol{C}$ 为 $n$ 阶正定矩阵, 则矩阵 $\boldsymbol{C}$ 可分解为
$$
\boldsymbol{C}=\boldsymbol{T}\boldsymbol{T}^{\mathrm{T}}
$$
其中 $\boldsymbol{T}$ 为下三角矩阵.

### 谱分解

设 $\boldsymbol{A}$ 为 $n$ 阶对称方阵, 其特征值为 $\lambda_1,\cdots,\lambda_n$, 其正交标准化特征向量为 $\boldsymbol{\varphi}_1,\cdots,\boldsymbol{\varphi}_n$, 则矩阵 $\boldsymbol{A}$ 可分解为
$$
\boldsymbol{A}=\boldsymbol{P}\boldsymbol{\Lambda}_n\boldsymbol{P}^{\mathrm{T}}=\sum_{i=1}^n\lambda_i\boldsymbol{\varphi}_i\boldsymbol{\varphi}_i^{\mathrm{T}}
$$
其中 $\boldsymbol{P}=(\boldsymbol{\varphi}_1,\cdots,\boldsymbol{\varphi}_n)$ 为 $n$ 阶正交方阵, $\boldsymbol{\Lambda}_n=\mathrm{diag}(\lambda_1,\cdots,\lambda_n)$ 为 $n$ 阶对角方阵.

设 $\boldsymbol{A}$ 为 $n$ 阶对称方阵, 则有
$$
\begin{align}
\mathrm{tr}(\boldsymbol{A})&=\sum_{i=1}^n\lambda_i\\
|\boldsymbol{A}|&=\prod_{i=1}^n\lambda_i
\end{align}
$$

当矩阵 $\boldsymbol{A}$ 不满秩时, 即 $\mathrm{rank}(A)=r<n$ 时, 则 $\boldsymbol{A}$ 仅有 $r$ 个非零特征值 $\lambda_1,\cdots,\lambda_r$, 则
$$
\boldsymbol{\Lambda}_n=
\begin{bmatrix}
\boldsymbol{\Lambda}_r & \boldsymbol{0}\\
\boldsymbol{0}& \boldsymbol{0}\\
\end{bmatrix}
$$
其中 $\boldsymbol{\Lambda}_r=\mathrm{diag}(\lambda_1,\cdots,\lambda_r)$. 若相应地对 $\boldsymbol{P}$ 进行分块, 使得 $\boldsymbol{P}_1$ 为 $n\times r$ 的矩阵
$$
\boldsymbol{P}=(\boldsymbol{P}_1,\boldsymbol{P}_2)
$$
则 $\boldsymbol{A}$ 的满秩谱分解为
$$
\boldsymbol{A}=\boldsymbol{P}_1\begin{bmatrix}
\boldsymbol{\Lambda}_r & \boldsymbol{0}\\
\boldsymbol{0}& \boldsymbol{0}\\
\end{bmatrix}\boldsymbol{P}_1^{\mathrm{T}}=\boldsymbol{P}_1\boldsymbol{\Lambda}_r\boldsymbol{P}_1^{\mathrm{T}}
$$

### 奇异值分解

设 $\boldsymbol{A}$ 为 $m\times n$ 的矩阵, 且 $\mathrm{rank}(A)=r$, 则存在两正交方阵 $\boldsymbol{P}$ 和 $\boldsymbol{Q}$, 使得 $\boldsymbol{A}$ 可分解为
$$
\boldsymbol{A}=\boldsymbol{P}\begin{bmatrix}
\boldsymbol{\Lambda}_r & \boldsymbol{0}\\
\boldsymbol{0}& \boldsymbol{0}\\
\end{bmatrix}\boldsymbol{Q}^{\mathrm{T}}=\boldsymbol{P}_1\boldsymbol{\Lambda}_r\boldsymbol{Q}_1^{\mathrm{T}}
$$
其中
$$
\begin{align}
\boldsymbol{P}&=(\boldsymbol{P}_1,\boldsymbol{P}_2)\\
\boldsymbol{Q}&=(\boldsymbol{Q}_1,\boldsymbol{Q}_2)\\
\boldsymbol{\Lambda}_r&=\mathrm{diag}(\lambda_1,\cdots,\lambda_r)
\end{align}
$$
且 $\lambda_i>0$ 为 $\boldsymbol{A}$ 的奇异值, $\lambda_i^2$ 为 $\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}$ 的非零特征值, $\boldsymbol{P}_1$ 和 $\boldsymbol{Q}_1$ 的列向量分别为 $\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}}$ 和 $\boldsymbol{A}^{\mathrm{T}}\boldsymbol{A}$ 对应的 $r$ 个非零特征值的标准正交化的特征向量.